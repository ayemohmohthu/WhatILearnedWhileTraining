## モデリングとは
```
システムの開発において、業務の流れや構造などを抽象化し、全体像を把握するシステム構築技法の1つ。
業務の流れや構造を抽象化したものを「モデル」、業務の可視化を「ビジネスモデリング」と呼ぶ。
複雑化するシステム要求を明確にするために、不必要な情報をそぎ落とし、本質的な部分に焦点を当てて、情報を正しく確実に伝えることが目的である。

システム構築の前工程から中盤にモデルを作成し、UML（Unified Modeling Language「統一モデリング言語」）を使用してモデリングを行う。
UMLは、複雑な情報を「ダイアグラム」と呼ばれる図を使って分かりやすく表記する、オブジェクト指向の分析手法だ。
```
| ダイアグラム | 目的 |
|:-----------|:------------|
| ユースケース図 | ユーザがシステムに要求する機能や振る舞いを表現する |
| クラス図 | クラス間の静的なつながりを表現する |
| オブジェクト図 | オブジェクト間の静的なつながりを表現する |
| シーケンス図（相互作用図）| オブジェクト間の協調動作を時系列で表現する |
| コラボレーション図（相互作用図）| オブジェクト間の協調動作を平面的に表現する |
| ステートチャート図 | 特定のオブジェクトの状態の変化を表現する |
| アクティビティ図 | ひとまとまりの手順の流れを表現する |
| コンポーネント図 | プログラム間の依存関係を表現する |

## モデリング歴史
POA = Process Oriented Architecture
DOA = Data Oriented Architecture
OOA = Object Oriented Architecture
DDD = Domain Driven Design
PofEAA = Patterns of Enterprise Application Architecture

## クラス図
* リソースとイベントでクラスを作成
　リソース = 物
　イベント = 事 (create_atが大事)
* クラス間に関係が色々ある。
　・継承関係（△）
　・コンポジション関連（♢、♦︎）
　　・♦︎　= life cycleの場合（一つがなくなった場合、もう一つもなくなる意味）
　　　・例：本とバーコード　（本がなくなったら、バーコードも消える）
　　　・実装なら、インスタンス変数のこと。
* 関係線には多重度を付けれる。
　・0..1,0..* ,...

#### STI（oSingle Table Inheritance) 単一継承テーブル　とは
STIは、単一の継承階層に所属するクラス群を、ただひとつのテーブルを使って永続化する手法です。
PofEAAの中で取り上げられたパターンの1つなのです。
```
同じサイトでClass Table Inheritance(クラステーブル継承)、Concrete Table Inheritance(具象テーブル継承)というパターンも紹介されていますが、STIも含めたこれら3つは、「オブジェクト指向設計で抽出されたスーパークラス・サブクラスから成る継承階層をリレーショナルデータベースのテーブルとして実装するためのパターン」という意味で同類です。
```
* 長所
    * 必要なテーブルは1つのみで、サブクラスが増えてもテーブル数は増えない
    * 論理的なレコード全体を取得するのにジョイン不要
    * レコードのサブクラスの変更が容易
    * Railsでネイティブサポートされているのでコーディングが容易
* 短所
    * 特定のサブクラスに固有の属性に対してNOT NULL制約を適用できない
    * 特定のサブクラスのみを参照すべき他テーブルの外部キー制約が、誤ったサブクラスを参照することを防げない
    * テーブルのカラム数が多くなりやすい
    * 一部のサブクラスでしか使われない列の値はNULLばかりとなり、見た目がスパースになる

#### Class Table Inheritance / クラステーブル継承
Class Table Inheritanceパターンに従うと、4つのクラスそれぞれに対してテーブルを作成します。
各クラスに対応するテーブルは、そのクラス自身とサブクラスに固有の共通属性のためのカラムのみを持ちます。

Railsのモデルにはこの方法のサポートはないので、通常通り各クラスに対応したテーブルを作成することになり
* 長所
   * STIにおけるNOT NULL制約や外部キー制約の問題が発生しない
   * NULLの発生を抑制できる
* 短所
   * サブクラスが増えるとテーブルも増える
   * 論理的なレコード全体を取得するのにジョインが必要
   * Railsでは、サブクラス固有属性を取得するためにコードを書く必要がある

#### Concrete Class Inheritance / 具象クラス継承
Concrete Class Inheritanceパターンでは、具象クラスにのみ対応するテーブルを作成します。
各テーブルはスーパークラスから継承する共通属性も含め、その具象クラスが持つすべての属性のためのカラムを持ちます。
* 長所
    * 論理的なレコード全体を取得するのにジョイン不要
    * STIにおけるNOT NULL制約の問題が発生しない
    * NULLの発生を抑制できる
    * テーブルが肥大化しにくい
* 短所
    * 具象サブクラスが増えるとテーブルも増える
    * スーパークラスの共通属性にユニーク制約を適用できない
        * ユニーク制約は複数のテーブルをまたがれないので、そのようなユニーク性はアプリケーションで保証する必要がある
        * 例における`code`列
    * 別テーブルの外部キー制約で参照できるのは単一の具象クラスのみ
        * 外部キー制約は単一のテーブルしか参照できないので、複数の具象クラスを参照できる場合には実装できない
    * スーパークラスの共通属性をキーとするクエリーでは、全ての具象クラステーブルを検索する必要がある
    * Railsでは`Customer.where`など、スーパークラスのクエリーメソッドを自前で実装する必要がある  

* https://qiita.com/yebihara/items/9ecb838893ad99be0561  

#### ベースとメタ
* 実装上の考えなら、クラスとインスタンスの場合、インスタンスがベース、クラスがメタ。
* http://blogs.itmedia.co.jp/itphilosophy/2005/12/post_294b.html

#### ActiveRecordとは
* ObjectRelationMappingFrameworkとして使う
   * ModelとModelのなかのデータを表現する。
   * Model間のアソシエーションを表現する。
   * 関係のあるModelのInheritanceと継承を表現する。
   * DataValidationのためも使う。
   * Object Oriented Notation WayでDBを操作する。
